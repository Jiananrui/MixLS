% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mels.R
\name{mels}
\alias{mels}
\title{Fit Mixed-Effects Location Scale Model}
\usage{
mels(
  data,
  id,
  response,
  fixed,
  bs,
  ws,
  nq = 11,
  maxiter = 200,
  tol = 1e-05,
  stage = 3,
  type = "linear",
  ridge1 = 0,
  ridge2 = 0.1,
  ridge3 = 0.2,
  adaptive = 1,
  verbose = TRUE
)
}
\arguments{
\item{data}{Data frame containing all variables}

\item{id}{Name of the column containing subject identifiers}

\item{response}{Name of the column containing response values}

\item{fixed}{Formula for the fixed effects (mean) model}

\item{bs}{Formula for the between-subject variance model}

\item{ws}{Formula for the within-subject variance model (used for Stage 2 & 3)}

\item{nq}{Number of quadrature points (default: 11)}

\item{maxiter}{Maximum number of iterations for optimization (default: 200)}

\item{tol}{Convergence tolerance (default: 1e-5)}

\item{stage}{Which stages to fit: 1, 2, or 3. Stage 2 fits 1 & 2. Stage 3 fits 1, 2, & 3. (default: 3)}

\item{type}{A character vector specifying Stage 3 models to fit (e.g., "linear", c("linear", "quadratic")). Use "all" to fit all types.}

\item{ridge1}{Stage 1 initial ridge parameter value (default: 0)}

\item{ridge2}{Stage 2 initial ridge parameter value (default: 0.1)}

\item{ridge3}{Stage 3 initial ridge parameter value (default: 0.2)}

\item{adaptive}{Use adaptive quadrature (0 = fixed, 1 = adaptive) (default: 0)}

\item{verbose}{Logical. If TRUE, print iteration details during fitting. If FALSE, suppress output (default: FALSE)}
}
\value{
A mels object containing model results
}
\description{
Main function to fit a mixed-effects location scale model with heterogeneous within-subject variances
}
