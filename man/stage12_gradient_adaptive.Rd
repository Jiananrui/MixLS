% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{stage12_gradient_adaptive}
\alias{stage12_gradient_adaptive}
\title{Calculate gradient for Stage 1 & 2 with adaptive quadrature}
\usage{
stage12_gradient_adaptive(
  params,
  X,
  U,
  Z,
  y,
  id,
  points,
  weights,
  adaptive,
  theta_eb,
  psd_eb
)
}
\arguments{
\item{params}{Vector of parameters (beta, alpha, tau).}

\item{X}{Design matrix for fixed effects.}

\item{U}{Design matrix for between-subject variance.}

\item{Z}{Design matrix for within-subject variance.}

\item{y}{Vector of response values.}

\item{id}{Vector of subject identifiers (0-based).}

\item{points}{Standard Gaussian-Hermite quadrature points.}

\item{weights}{Standard Gaussian-Hermite quadrature weights.}

\item{adaptive}{Integer flag (1 for adaptive, 0 for fixed).}

\item{theta_eb}{Vector of EB posterior means for each subject.}

\item{psd_eb}{Vector of EB posterior standard deviations for each subject.}
}
\value{
A vector containing the gradient of the log-likelihood.
}
\description{
This function computes the gradient using adaptive Gaussian-Hermite quadrature,
where the integration grid is centered and scaled based on Empirical Bayes
estimates from the previous iteration.
}
