% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{update_eb_estimates_stage3_rcpp}
\alias{update_eb_estimates_stage3_rcpp}
\title{Update Bivariate Empirical Bayes Estimates for Stage 3}
\usage{
update_eb_estimates_stage3_rcpp(
  params,
  X,
  U,
  Z,
  y,
  id,
  points,
  weights,
  model_type,
  adaptive,
  eb_prev_theta2,
  eb_prev_thetav
)
}
\arguments{
\item{params}{A vector of model parameters (beta, alpha, tau, sigma).}

\item{X}{Design matrix for fixed effects.}

\item{U}{Design matrix for between-subject variance.}

\item{Z}{Design matrix for within-subject variance.}

\item{y}{The response vector.}

\item{id}{A vector of subject IDs.}

\item{points}{Vector of standard Quadrature points.}

\item{weights}{Vector of standard Quadrature weights.}

\item{model_type}{String specifying the model type ("independent", "linear", "quadratic" and "interaction").}

\item{adaptive}{Integer flag (0 or 1) indicating if adaptive quadrature is used.}

\item{eb_prev_theta2}{Matrix (n x 2) of previous EB mean estimates.}

\item{eb_prev_thetav}{Matrix (n x 3) of previous EB variance-covariance estimates (var1, cov, var2).}
}
\value{
A list containing:
\item{theta2_eb}{Updated matrix (n x 2) of random effect means.}
\item{thetav_eb}{Updated matrix (n x 3) of variances and covariance.}
}
\description{
Updates the bivariate EB estimates for the mixed effects location-scale model.
Handles independent, linear, interaction, and quadratic model types.
}
\keyword{internal}
