% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{update_eb_estimates_stage3_rcpp}
\alias{update_eb_estimates_stage3_rcpp}
\title{Update Bivariate Empirical Bayes Estimates for Stage 3}
\usage{
update_eb_estimates_stage3_rcpp(
  params,
  X,
  U,
  Z,
  y,
  id,
  points,
  weights,
  model_type,
  adaptive,
  eb_prev_theta2,
  eb_prev_thetav
)
}
\arguments{
\item{params}{Vector of current model parameters (beta, alpha, tau, sigma).}

\item{X}{Design matrix for fixed effects.}

\item{U}{Design matrix for between-subject variance.}

\item{Z}{Design matrix for within-subject variance.}

\item{y}{Response vector.}

\item{id}{Vector of subject identifiers (0-based).}

\item{points}{Standard Gaussian-Hermite quadrature points.}

\item{weights}{Standard Gaussian-Hermite quadrature weights.}

\item{model_type}{A string specifying the Stage 3 model type ("linear", "quadratic", etc.).}

\item{adaptive}{An integer flag (1 for adaptive quadrature, 0 for fixed).}

\item{eb_prev_theta2}{A matrix (n_subjects x 2) of the posterior means from the previous iteration.}

\item{eb_prev_thetav}{A matrix (n_subjects x 3) of the unique posterior
variance-covariance elements [Var1, Cov, Var2] from the previous iteration.}
}
\value{
A Rcpp::List containing two named elements: `theta2_eb` (a matrix of the
  updated posterior means) and `thetav_eb` (a matrix of the updated posterior
  variance-covariance elements).
}
\description{
This function calculates the posterior mean vector (2x1) and variance-covariance matrix
(2x2) for the bivariate random effects (location and scale) in the Stage 3 model.
It uses 2D numerical integration and is parallelized across subjects.
}
