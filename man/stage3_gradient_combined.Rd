% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{stage3_gradient_combined}
\alias{stage3_gradient_combined}
\title{Calculate gradient for Stage 3 mixed-effects location-scale model}
\usage{
stage3_gradient_combined(
  params,
  X,
  U,
  Z,
  y,
  id,
  points,
  weights,
  model_type = "linear"
)
}
\arguments{
\item{params}{Vector of parameters (beta, alpha, tau, sigma).}

\item{X}{Design matrix for fixed effects.}

\item{U}{Design matrix for between-subject variance.}

\item{Z}{Design matrix for within-subject variance.}

\item{y}{Vector of response values.}

\item{id}{Vector of subject identifiers (0-based).}

\item{points}{Standard Gaussian-Hermite quadrature points.}

\item{weights}{Standard Gaussian-Hermite quadrature weights.}

\item{model_type}{A string specifying the Stage 3 model type ("linear", etc.).}
}
\value{
A vector containing the gradient of the log-likelihood.
}
\description{
This function computes the gradient for the Stage 3 model, which includes
bivariate random effects for location and scale. It uses 2D numerical
integration and is parallelized across subjects.
}
