% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{update_eb_estimates_rcpp}
\alias{update_eb_estimates_rcpp}
\title{Update Empirical Bayes Estimates for Stage 1 & 2}
\usage{
update_eb_estimates_rcpp(
  params,
  X,
  U,
  Z,
  y,
  id,
  points,
  weights,
  eb_prev_theta,
  eb_prev_psd
)
}
\arguments{
\item{params}{Vector of current model parameters (beta, alpha, tau).}

\item{X}{Design matrix for fixed effects.}

\item{U}{Design matrix for between-subject variance.}

\item{Z}{Design matrix for within-subject variance.}

\item{y}{Response vector.}

\item{id}{Vector of subject identifiers (0-based).}

\item{points}{Standard Gaussian-Hermite quadrature points.}

\item{weights}{Standard Gaussian-Hermite quadrature weights.}

\item{eb_prev_theta}{EB mean estimates from the previous iteration.}

\item{eb_prev_psd}{EB standard deviation estimates from the previous iteration.}
}
\value{
A Rcpp::List containing two named elements: `theta_eb` (a vector of the
  updated posterior means) and `psd_eb` (a vector of the updated posterior
  standard deviations).
}
\description{
This function calculates the posterior mean and standard deviation for the random
intercept in the Stage 1 & 2 models. It uses the parameter estimates from the
current iteration to perform numerical integration via Gaussian quadrature for
each subject. The calculation is parallelized across subjects using OpenMP.
}
