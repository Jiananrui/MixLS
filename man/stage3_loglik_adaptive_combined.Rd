% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{stage3_loglik_adaptive_combined}
\alias{stage3_loglik_adaptive_combined}
\title{Calculate log-likelihood for Stage 3 (Adaptive Quadrature)}
\usage{
stage3_loglik_adaptive_combined(
  params,
  X,
  U,
  Z,
  y,
  id,
  points,
  weights,
  model_type,
  adaptive,
  eb_theta2,
  eb_thetav
)
}
\arguments{
\item{params}{A vector of model parameters (beta, alpha, tau, sigma).}

\item{X}{Design matrix for fixed effects.}

\item{U}{Design matrix for between-subject variance.}

\item{Z}{Design matrix for within-subject variance.}

\item{y}{The response vector.}

\item{id}{A vector of subject IDs.}

\item{points}{Vector of standard Quadrature points.}

\item{weights}{Vector of standard Quadrature weights.}

\item{model_type}{String specifying the model type ("independent", "linear", "quadratic" and "interaction").}

\item{adaptive}{Integer flag (0 or 1) indicating if adaptive quadrature is used.}

\item{eb_theta2}{Matrix (n x 2) of Empirical Bayes estimates for random effect means.}

\item{eb_thetav}{Matrix (n x 3) of Empirical Bayes estimates for random effect variances/covariances.}
}
\value{
The total log-likelihood (scalar double).
}
\description{
Computes the marginal log-likelihood for the Stage 3 model (bivariate random effects)
using adaptive Gaussian quadrature.
}
\keyword{internal}
